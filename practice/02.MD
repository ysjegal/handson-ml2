# 02. 머신러닝 프로젝트 처음부터 끝까지 요약

부동산 회사의 데이터 과학자

단계 1. 큰 그림 보기

캘리포니아 인구조사 데이터를 사용해 캘리포니아 주택 가격 모델 만들기

1-1 문제 정의

비즈니스의 목적이 무엇일까? - 이 모델의 출력(구역의 중간 주택 가격에 대한 예측)이 여러 가지 다른 신호와 함께 다른 머신러닝 시스템에 입력으로 사용됨

현재 솔루션은 어떻게 구성되어 있는가? - 현재는 구역 주택 가격을 전문가가 수동으로 추정함.

문제 정의 -> 지도 학습 / 단변량 회귀

----
1-2 성능 측정 지표 선택

회귀 문제 전형적인 성능 지표 -> 평균 제곱근 오차 root mean square error (RMSE) 

이상치가 많은 경우 -< 평균 절대 오차 mean absolute error (MAE)

RMSE와 MAE 모두 예측값의 벡터와 타깃값의 벡터 사이의 거리를 재는 방법. 거리 측정에는 여러 가지 방법 (또는 노름 norm)이 가능

----

1-3 가정 검사

지금까지 만든 가정 나열/검사

---

단계 2. 데이터 가져오기

2-1 작업환경 만들기

-------

2-2 데이터 다운로드

데이터를 다운로드하는 함수를 준비하면 데이터가 정기적으로 바뀌는 경우에 유용함.

-----

2-3 데이터 구조 훑어보기

head()
info()

범주형 특성일 경우 - df["feature"].value_counts()
숫자형 특성 요약 - describe()

데이터의 형태를 빠르게 검토하는 방법 - 각 숫자형 특성을 히스토그램으로 그려보는 것.

%matplotlib inline
import matplotlib.pyplot as ply
df.hist(bins=n)
plt.show()

데이터셋에 최댓값과 최솟값이 한정되어있다면, 문제가 될 수 있으므로 검토. 한곗값 밖 구역의 정확한 레이블을 구하거나, 데이터셋에서 제거.
특성 스케일링
히스토그램 꼬리 - 종 모양의 분포가 되도록 변형시키기.

주의 ) 데이터를 더 깊게 들여다보기 전에 테스트 세트를 따로 떼어놓아야 함. 테스트 세트를 절대 들여다보면 안 됨.

----------

2-4 테스트 세트 만들기

테스트 세트로 일반화 오차를 추정하면 매우 낙관적인 추정이 된다. - 데이터 스누핑

난수 발생기의 초깃값 지정.

사이킷런의 train_test_split(df, test_size = 0.2, random_state=42)

계층적 샘플링 stratified sampling

------

단계 3. 데이터 이해를 위한 탐색과 시각화

3-1 지리적 데이터 시각화

지리 정보 (위도 경도) - 모든 구역을 산점도로 만들어 시각화
alpha=0.1 -> 밀집된 영역을 잘 보여줌

------

3-2 상관관계 조사

데이터셋이 너무 크지 않으므로 모든 특성 간의 표준 상관계수 (피어슨의 r) 를 corr() 메서드를 이용해 계산

------

3-3 특성 조합으로 실험

프로토타입을 만들고 실행한 후 그 결과를 분석해서 더 많은 통찰을 얻고 다시 이 탐색 단계로 돌아오게 됨.

--------------------------------

단계 4. 머신러닝 알고리즘을 위한 데이터 준비

이 작업을 자동화해야 하는 이유가 있다.
- 어떤 데이터셋에 대해서도 데이터 변환을 손쉽게 반복
- 향후 프로젝트에 사용할 수 있는 변환 라이브러리를 점진적으로 구축하게 됨
- 실제 시스템에서 알고리즘에 새 데이터를 주입하기 전에 변환시키는 데 이 함수를 사용할 수 있음
- 여러 가지 데이터 변환을 쉽게 시도해볼 수 있고 어떤 조합이 가장 좋은지 확인하는 데 편리함

4-1 데이터 정제

누락된 특성 관리 - 해당 구역 제거 or 전체 특성 삭제 or 어떤 값으로 채움(0, 평균, 중간값 등) / dropna(), drop(), fillna() 메서드 이용
df.dropna(subset=["feature"])
df.drop("feature", axis=1)
median = df["feature"].median()
df['feature'].fillna(median, inplace=True)

사이킷런 SimpleImputer 

-----
4-2 텍스트와 범주형 특성 다루기

OrdinalEncoder 클래스 사용

문제점 - 머신러닝 알고리즘이 가까이 있는 두 값이 떨어져 있는 두 값보다 더 비슷하다고 생각한다는 점
('bad', 'average', 'good' 과 같이 순서가 있는 카테고리의 경우 괜찮음)

이러한 문제는 일반적으로 카테고리별 이진 특성을 만들어 해결함 - 원-핫 인코딩. 더미 특성 생성.
사이킷런 OneHotEncoder 클래스

출력은 사이파이 희소 행렬 - 수천 개의 카테고리가 있는 범주형 특성일 경우 매우 효율적, 0이 아닌 원소의 위치만 저장

----
4-3 나만의 변환기


